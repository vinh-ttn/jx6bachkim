--Ô½ÄÏÁ½ÖÜÄê»î¶¯£¬ÀñÆ·ºÐ
--fmz
--
--
socola_loai4 = {
    tRan = {1000},
    tItemID = { {6,1,907}},
    tItemName = {"Qu¶ Hoµng Kim"}
}
--
socola_loai3 = {
    tRan = {10,15,25,125,175,195,295,1000},
    tItemID = {
        {6,1,23},
        {6,1,12},
        {4,353,1},
        {6,1,147,1},
        {6,1,147,2},
        {6,1,147,3},
        {6,1,125},
        {6,1,976},
    },
    tItemName = {"ThiÕt La H¸n","Bµn Nh­îc T©m Kinh","Tinh hång b¶o th¹ch","HuyÒn tinh kho¸ng th¹ch cÊp 1","HuyÒn tinh kho¸ng th¹ch cÊp 2","HuyÒn tinh kho¸ng th¹ch cÊp 3",
    "QuÕ Hoa Töu","Bao MÆt n¹",}
}
--
socola_loai2 = {
    tRan = {30,124,174,194,344,944,946,948,950,952,954,956,958,960,962,964,966,968,970,972,974,976,978,980,982,984,986,988,990,992,994,996,998,1000,},
    tItemID = {
        {6,1,23},
        {6,1,147,2},
        {6,1,147,3},
        {6,1,147,4},
        {4,239,1670},
        {6,1,1444},
        {6,1,27},
        {6,1,28},
        {6,1,33},
        {6,1,34},
        {6,1,35},
        {6,1,36},
        {6,1,37},
        {6,1,38},
        {6,1,39},
        {6,1,40},
        {6,1,41},
        {6,1,42},
        {6,1,43},
        {6,1,45},
        {6,1,46},
        {6,1,47},
        {6,1,48},
        {6,1,49},
        {6,1,50},
        {6,1,51},
        {6,1,52},
        {6,1,53},
        {6,1,54},
        {6,1,55},
        {6,1,56},
        {6,1,57},
        {6,1,58},
        {6,1,59},
    },
   tItemName = {"ThiÕt La H¸n","HuyÒn tinh kho¸ng th¹ch cÊp 2","HuyÒn tinh kho¸ng th¹ch cÊp 3","HuyÒn tinh kho¸ng th¹ch cÊp 4","Tö thñy tinh","TÝn vËt m«n ph¸i","Tô TiÔn thuËt. B¹o Vò Lª Hoa", 
"H·m TÜnh thuËt.Lo¹n Hoµn KÝch","Th¸i Cùc QuyÒn Phæ. QuyÓn 3","Th¸i Cùc KiÕm Phæ. QuyÓn 2","V©n Long KÝch. M©u ph¸p","L­u Tinh. §ao ph¸p","Thiªn V­¬ng Chïy Ph¸p. QuyÓn 1", 
"Thiªn V­¬ng Th­¬ng ph¸p. QuyÓn 2","Thiªn V­¬ng §ao ph¸p.QuyÓn 3","Thóy Yªn §ao ph¸p","Thóy Yªn Song ®ao","DiÖt KiÕm MËt TÞch","Nga Mi  PhËt Quang Ch­ëng MËt TÞch","Phi §ao thuËt. NhiÕp Hån NguyÖt ¶nh", 
"Phi Tiªu thuËt. Cöu Cung Phi Tinh","Ngò §éc Ch­ëng Ph¸p. QuyÓn 1","Ngò §éc §ao ph¸p. QuyÓn 2","Ngò §éc NhiÕp T©m thuËt. QuyÓn 3","Ngù Phong thuËt","Ngù L«i thuËt","Ngù T©m thuËt", 
"NhiÕp Hån. Chó thuËt","C¸i Bang Ch­ëng Ph¸p","C¸i Bang C«n ph¸p","ThiÕu L©m QuyÒn Ph¸p. QuyÓn 1","ThiÕu L©m C«n ph¸p. QuyÓn 2","ThiÕu L©m §ao ph¸p. QuyÓn 3","Phæ §é MËt TÞch" }
}
---
socola_loai1 = {
    tRan = {30,124,174,194,344,944,946,948,950,952,954,956,958,960,962,964,966,968,970,972,974,976,978,980,982,984,986,988,990,992,994,996,998,1000,},
    tItemID = {
        {6,1,23},
        {6,1,147,2},
        {6,1,147,3},
        {6,1,147,4},
        {4,239,1},
        {6,1,1670},
        {6,1,27},
        {6,1,28},
        {6,1,33},
        {6,1,34},
        {6,1,35},
        {6,1,36},
        {6,1,37},
        {6,1,38},
        {6,1,39},
        {6,1,40},
        {6,1,41},
        {6,1,42},
        {6,1,43},
        {6,1,45},
        {6,1,46},
        {6,1,47},
        {6,1,48},
        {6,1,49},
        {6,1,50},
        {6,1,51},
        {6,1,52},
        {6,1,53},
        {6,1,54},
        {6,1,55},
        {6,1,56},
        {6,1,57},
        {6,1,58},
        {6,1,59},
    },
   tItemName = {"ThiÕt La H¸n","HuyÒn tinh kho¸ng th¹ch cÊp 2","HuyÒn tinh kho¸ng th¹ch cÊp 3","HuyÒn tinh kho¸ng th¹ch cÊp 4","Tö thñy tinh","TÝn vËt m«n ph¸i","Tô TiÔn thuËt. B¹o Vò Lª Hoa", 
"H·m TÜnh thuËt.Lo¹n Hoµn KÝch","Th¸i Cùc QuyÒn Phæ. QuyÓn 3","Th¸i Cùc KiÕm Phæ. QuyÓn 2","V©n Long KÝch. M©u ph¸p","L­u Tinh. §ao ph¸p","Thiªn V­¬ng Chïy Ph¸p. QuyÓn 1", 
"Thiªn V­¬ng Th­¬ng ph¸p. QuyÓn 2","Thiªn V­¬ng §ao ph¸p.QuyÓn 3","Thóy Yªn §ao ph¸p","Thóy Yªn Song ®ao","DiÖt KiÕm MËt TÞch","Nga Mi  PhËt Quang Ch­ëng MËt TÞch","Phi §ao thuËt. NhiÕp Hån NguyÖt ¶nh", 
"Phi Tiªu thuËt. Cöu Cung Phi Tinh","Ngò §éc Ch­ëng Ph¸p. QuyÓn 1","Ngò §éc §ao ph¸p. QuyÓn 2","Ngò §éc NhiÕp T©m thuËt. QuyÓn 3","Ngù Phong thuËt","Ngù L«i thuËt","Ngù T©m thuËt", 
"NhiÕp Hån. Chó thuËt","C¸i Bang Ch­ëng Ph¸p","C¸i Bang C«n ph¸p","ThiÕu L©m QuyÒn Ph¸p. QuyÓn 1","ThiÕu L©m C«n ph¸p. QuyÓn 2","ThiÕu L©m §ao ph¸p. QuyÓn 3","Phæ §é MËt TÞch" }
}
--
function main(nItemIndex)
    local szItemName = GetItemName(nItemIndex)
    local tRan = {}
    local g, d , p = GetItemProp( nItemIndex )
    if p ==  3525 then
        tRan = socola_loai4
    elseif p == 3526 then
        tRan = socola_loai3
    elseif p == 3527 then
        tRan = socola_loai2
     elseif p == 3528 then
        tRan = socola_loai1
    end
    local nMedalItemGID, nMedalItemDID,nMedalItemPID,nItemLev,szMedalItemName = act2years2007_getgift(tRan)
    if nMedalItemGID == nil or nMedalItemDID == nil or nMedalItemPID  == nil  or szMedalItemName == nil then
        Msg2Player("Sö dông thÊt b¹i, xin mêi thö mét lÇn n÷a.")
        return 1
    end
    --Èç¹û²»ÊÇÐþ¾§
    if nMedalItemPID ~= 147 then
        nItemLev = 1
    end
    AddItem(nMedalItemGID,nMedalItemDID,nMedalItemPID,nItemLev,0,0)
    Msg2Player(format("Chóc mõng ngµi ®¹t ®­îc 1%s.",szMedalItemName))
    return 0
end
--
function act2years2007_getgift(tRan)
    
    local nCurRan,nMaxNumber
    local nMaxRan = 1000
    nCurRan = random(nMaxRan)
    nMaxNumber = getn(tRan.tRan)
    for i = 1, nMaxNumber do
        if nCurRan <= tRan.tRan[i] then
            return tRan.tItemID[i][1],tRan.tItemID[i][2],tRan.tItemID[i][3],tRan.tItemID[i][4], tRan.tItemName[i]
        end
    end
end
